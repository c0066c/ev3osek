<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.10"/>
<title>EV3-OSEK: leJOS_EV3/src/ev3/ninja/spi.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">EV3-OSEK
   &#160;<span id="projectnumber">1.0</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.10 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_8ed1dde280f261b41bce9360cd3fdf32.html">leJOS_EV3</a></li><li class="navelem"><a class="el" href="dir_4ec2a68c26dfdc62fc66567ff851cecb.html">src</a></li><li class="navelem"><a class="el" href="dir_f628051c74760437d1b13574f9e26eb0.html">ev3</a></li><li class="navelem"><a class="el" href="dir_56bb3b8850cdbbebe5c98ece8dab465b.html">ninja</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">spi.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>This contains function definitions required to interact with the SPI0 controller of the SoC which is connected to the ADC.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;<a class="el" href="ninja_2spi_8h_source.html">spi.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="ninja_2gpio_8h_source.html">gpio.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="pininfo_8h_source.html">pininfo.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="systick_8h_source.html">systick.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for spi.c:</div>
<div class="dyncontent">
<div class="center"><img src="ninja_2spi_8c__incl.png" border="0" usemap="#le_j_o_s___e_v3_2src_2ev3_2ninja_2spi_8c" alt=""/></div>
<map name="le_j_o_s___e_v3_2src_2ev3_2ninja_2spi_8c" id="le_j_o_s___e_v3_2src_2ev3_2ninja_2spi_8c">
<area shape="rect" id="node2" href="ninja_2spi_8h.html" title="This header declares function required to interact with the SPI0 controller of the SoC which is conne..." alt="" coords="5,95,56,121"/>
<area shape="rect" id="node3" href="ninja_2gpio_8h.html" title="This header declares function required to interact with GPIO pins of the SoC. " alt="" coords="81,95,138,121"/>
<area shape="rect" id="node5" href="pininfo_8h.html" title="This header defines the struct that represents a GPIO pin in the ev3ninja driver and makes the corres..." alt="" coords="162,95,233,121"/>
<area shape="rect" id="node6" href="systick_8h.html" title="This header contains function declarations required to manage the tick in milliseconds on the EV3..." alt="" coords="257,95,332,121"/>
<area shape="rect" id="node4" href="hw__gpio_8h.html" title="GPIO register definitions. " alt="" coords="30,169,189,196"/>
<area shape="rect" id="node7" href="mytypes_8h.html" title="This header defines the data types used in the leJOS driver. " alt="" coords="253,169,336,196"/>
</map>
</div>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ad7af17cf30742fc29c9829b6bd94bb7a"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ad7af17cf30742fc29c9829b6bd94bb7a"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ninja_2spi_8c.html#ad7af17cf30742fc29c9829b6bd94bb7a">SPI0_CLOCK</a>&#160;&#160;&#160;150000000UL</td></tr>
<tr class="memdesc:ad7af17cf30742fc29c9829b6bd94bb7a"><td class="mdescLeft">&#160;</td><td class="mdescRight">The clock rate at which the SPI0 controller should run. <br /></td></tr>
<tr class="separator:ad7af17cf30742fc29c9829b6bd94bb7a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab66ed350f5009d26f2e70911e35113aa"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ab66ed350f5009d26f2e70911e35113aa"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ninja_2spi_8c.html#ab66ed350f5009d26f2e70911e35113aa">ADC_TIME</a>&#160;&#160;&#160;8UL</td></tr>
<tr class="memdesc:ab66ed350f5009d26f2e70911e35113aa"><td class="mdescLeft">&#160;</td><td class="mdescRight">The delay between 2 ADC convertions. <br /></td></tr>
<tr class="separator:ab66ed350f5009d26f2e70911e35113aa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1827eb5abf90948b5eaf230be00170fd"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a1827eb5abf90948b5eaf230be00170fd"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ninja_2spi_8c.html#a1827eb5abf90948b5eaf230be00170fd">ADC_CLOCK</a>&#160;&#160;&#160;((1000000UL * 16UL) / ADC_TIME)</td></tr>
<tr class="memdesc:a1827eb5abf90948b5eaf230be00170fd"><td class="mdescLeft">&#160;</td><td class="mdescRight">The clock rate at which the ADC runs. <br /></td></tr>
<tr class="separator:a1827eb5abf90948b5eaf230be00170fd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1200c12821ba1c1d5ed915d608e41127"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a1200c12821ba1c1d5ed915d608e41127"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ninja_2spi_8c.html#a1200c12821ba1c1d5ed915d608e41127">CNVSPD</a>&#160;&#160;&#160;((<a class="el" href="ninja_2spi_8c.html#ad7af17cf30742fc29c9829b6bd94bb7a">SPI0_CLOCK</a> / <a class="el" href="ninja_2spi_8c.html#a1827eb5abf90948b5eaf230be00170fd">ADC_CLOCK</a>) - 1)</td></tr>
<tr class="memdesc:a1200c12821ba1c1d5ed915d608e41127"><td class="mdescLeft">&#160;</td><td class="mdescRight">The maximum convertion speed. <br /></td></tr>
<tr class="separator:a1200c12821ba1c1d5ed915d608e41127"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa84b5e26da2355aec15cd5614b2e872e"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aa84b5e26da2355aec15cd5614b2e872e"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ninja_2spi_8c.html#aa84b5e26da2355aec15cd5614b2e872e">SPI0_OFFSET</a>&#160;&#160;&#160;(<a class="el" href="ninja_2gpio_8h.html#a17024ec92fb640f98ea920b98d2c324c">GPIO_PIN</a>(9, 0) + 5)</td></tr>
<tr class="memdesc:aa84b5e26da2355aec15cd5614b2e872e"><td class="mdescLeft">&#160;</td><td class="mdescRight">The offset of the first GPIO pin which can provide SPI functionality. <br /></td></tr>
<tr class="separator:aa84b5e26da2355aec15cd5614b2e872e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a16ce69be83444ff939653090fb7fa151"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a16ce69be83444ff939653090fb7fa151"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ninja_2spi_8c.html#a16ce69be83444ff939653090fb7fa151">SPI0_MOSI</a>&#160;&#160;&#160;(<a class="el" href="ninja_2spi_8c.html#aa84b5e26da2355aec15cd5614b2e872e">SPI0_OFFSET</a> + 0)</td></tr>
<tr class="memdesc:a16ce69be83444ff939653090fb7fa151"><td class="mdescLeft">&#160;</td><td class="mdescRight">The GPIO pin which provided the Master-Output-Slave-Input functionality for SPI0. <br /></td></tr>
<tr class="separator:a16ce69be83444ff939653090fb7fa151"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aabba8137ea69a9180bedb49e83873988"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aabba8137ea69a9180bedb49e83873988"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ninja_2spi_8c.html#aabba8137ea69a9180bedb49e83873988">SPI0_MISO</a>&#160;&#160;&#160;(<a class="el" href="ninja_2spi_8c.html#aa84b5e26da2355aec15cd5614b2e872e">SPI0_OFFSET</a> + 1)</td></tr>
<tr class="memdesc:aabba8137ea69a9180bedb49e83873988"><td class="mdescLeft">&#160;</td><td class="mdescRight">The GPIO pin which provided the Master-Input-Slave-Output functionality for SPI0. <br /></td></tr>
<tr class="separator:aabba8137ea69a9180bedb49e83873988"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1b745563682c155a14b1a65f8ebe0c47"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a1b745563682c155a14b1a65f8ebe0c47"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ninja_2spi_8c.html#a1b745563682c155a14b1a65f8ebe0c47">SPI0_SCL</a>&#160;&#160;&#160;(<a class="el" href="ninja_2spi_8c.html#aa84b5e26da2355aec15cd5614b2e872e">SPI0_OFFSET</a> + 2)</td></tr>
<tr class="memdesc:a1b745563682c155a14b1a65f8ebe0c47"><td class="mdescLeft">&#160;</td><td class="mdescRight">The GPIO pin which provided the Clock functionality for SPI0. <br /></td></tr>
<tr class="separator:a1b745563682c155a14b1a65f8ebe0c47"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5764b944b7809f264ff68d12652a7be0"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a5764b944b7809f264ff68d12652a7be0"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ninja_2spi_8c.html#a5764b944b7809f264ff68d12652a7be0">SPI0_CS</a>&#160;&#160;&#160;(<a class="el" href="ninja_2spi_8c.html#aa84b5e26da2355aec15cd5614b2e872e">SPI0_OFFSET</a> + 3)</td></tr>
<tr class="memdesc:a5764b944b7809f264ff68d12652a7be0"><td class="mdescLeft">&#160;</td><td class="mdescRight">The GPIO pin which provided the Chip Select functionality for SPI0. <br /></td></tr>
<tr class="separator:a5764b944b7809f264ff68d12652a7be0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4a3757b6bf87a9402b4cc6ff355dd015"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a4a3757b6bf87a9402b4cc6ff355dd015"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ninja_2spi_8c.html#a4a3757b6bf87a9402b4cc6ff355dd015">SPI_BASE</a>&#160;&#160;&#160;((volatile void*)0x01C41000)</td></tr>
<tr class="memdesc:a4a3757b6bf87a9402b4cc6ff355dd015"><td class="mdescLeft">&#160;</td><td class="mdescRight">The base address of the SPI0 control register. <br /></td></tr>
<tr class="separator:a4a3757b6bf87a9402b4cc6ff355dd015"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2fff656be3fb6ccee909f26d0e454bc4"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a2fff656be3fb6ccee909f26d0e454bc4"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ninja_2spi_8c.html#a2fff656be3fb6ccee909f26d0e454bc4">SPIGCR0</a>&#160;&#160;&#160;(*((volatile unsigned int*)(<a class="el" href="ninja_2spi_8c.html#a4a3757b6bf87a9402b4cc6ff355dd015">SPI_BASE</a> + 0x00)))</td></tr>
<tr class="memdesc:a2fff656be3fb6ccee909f26d0e454bc4"><td class="mdescLeft">&#160;</td><td class="mdescRight">The SPI0 global configuration register 0. <br /></td></tr>
<tr class="separator:a2fff656be3fb6ccee909f26d0e454bc4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a14f248c3740f5a81c030ca53e24a2c4f"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a14f248c3740f5a81c030ca53e24a2c4f"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ninja_2spi_8c.html#a14f248c3740f5a81c030ca53e24a2c4f">SPIGCR1</a>&#160;&#160;&#160;(*((volatile unsigned int*)(<a class="el" href="ninja_2spi_8c.html#a4a3757b6bf87a9402b4cc6ff355dd015">SPI_BASE</a> + 0x04)))</td></tr>
<tr class="memdesc:a14f248c3740f5a81c030ca53e24a2c4f"><td class="mdescLeft">&#160;</td><td class="mdescRight">The SPI0 global configuration register 1. <br /></td></tr>
<tr class="separator:a14f248c3740f5a81c030ca53e24a2c4f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0e7dc8948d4dfb1f2f00ed3eb8144c17"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a0e7dc8948d4dfb1f2f00ed3eb8144c17"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ninja_2spi_8c.html#a0e7dc8948d4dfb1f2f00ed3eb8144c17">SPIINT0</a>&#160;&#160;&#160;(*((volatile unsigned int*)(<a class="el" href="ninja_2spi_8c.html#a4a3757b6bf87a9402b4cc6ff355dd015">SPI_BASE</a> + 0x08)))</td></tr>
<tr class="memdesc:a0e7dc8948d4dfb1f2f00ed3eb8144c17"><td class="mdescLeft">&#160;</td><td class="mdescRight">The SPI0 interrupt register. <br /></td></tr>
<tr class="separator:a0e7dc8948d4dfb1f2f00ed3eb8144c17"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a88d156c265e8b6524c5d463fe73628eb"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a88d156c265e8b6524c5d463fe73628eb"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ninja_2spi_8c.html#a88d156c265e8b6524c5d463fe73628eb">SPIPC0</a>&#160;&#160;&#160;(*((volatile unsigned int*)(<a class="el" href="ninja_2spi_8c.html#a4a3757b6bf87a9402b4cc6ff355dd015">SPI_BASE</a> + 0x14)))</td></tr>
<tr class="memdesc:a88d156c265e8b6524c5d463fe73628eb"><td class="mdescLeft">&#160;</td><td class="mdescRight">The SPI0 pin control register 0. <br /></td></tr>
<tr class="separator:a88d156c265e8b6524c5d463fe73628eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1c5d129f5319809fa367a9232c31423e"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a1c5d129f5319809fa367a9232c31423e"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ninja_2spi_8c.html#a1c5d129f5319809fa367a9232c31423e">SPIDAT0</a>&#160;&#160;&#160;(*((volatile unsigned int*)(<a class="el" href="ninja_2spi_8c.html#a4a3757b6bf87a9402b4cc6ff355dd015">SPI_BASE</a> + 0x38)))</td></tr>
<tr class="memdesc:a1c5d129f5319809fa367a9232c31423e"><td class="mdescLeft">&#160;</td><td class="mdescRight">The SPI0 data transmit register 0. <br /></td></tr>
<tr class="separator:a1c5d129f5319809fa367a9232c31423e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac5b3fd94e87b5e8b307a086afbe1e78d"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ac5b3fd94e87b5e8b307a086afbe1e78d"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ninja_2spi_8c.html#ac5b3fd94e87b5e8b307a086afbe1e78d">SPIDAT1</a>&#160;&#160;&#160;(*((volatile unsigned int*)(<a class="el" href="ninja_2spi_8c.html#a4a3757b6bf87a9402b4cc6ff355dd015">SPI_BASE</a> + 0x3C)))</td></tr>
<tr class="memdesc:ac5b3fd94e87b5e8b307a086afbe1e78d"><td class="mdescLeft">&#160;</td><td class="mdescRight">The SPI0 data transmit register 1. <br /></td></tr>
<tr class="separator:ac5b3fd94e87b5e8b307a086afbe1e78d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3819917ebf65619cc08363b994124216"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a3819917ebf65619cc08363b994124216"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ninja_2spi_8c.html#a3819917ebf65619cc08363b994124216">SPIBUF</a>&#160;&#160;&#160;(*((volatile unsigned int*)(<a class="el" href="ninja_2spi_8c.html#a4a3757b6bf87a9402b4cc6ff355dd015">SPI_BASE</a> + 0x40)))</td></tr>
<tr class="memdesc:a3819917ebf65619cc08363b994124216"><td class="mdescLeft">&#160;</td><td class="mdescRight">The SPI0 receive buffer register. <br /></td></tr>
<tr class="separator:a3819917ebf65619cc08363b994124216"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae03a297fa1980db6a6193caa495165fe"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ae03a297fa1980db6a6193caa495165fe"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ninja_2spi_8c.html#ae03a297fa1980db6a6193caa495165fe">SPIDELAY</a>&#160;&#160;&#160;(*((volatile unsigned int*)(<a class="el" href="ninja_2spi_8c.html#a4a3757b6bf87a9402b4cc6ff355dd015">SPI_BASE</a> + 0x48)))</td></tr>
<tr class="memdesc:ae03a297fa1980db6a6193caa495165fe"><td class="mdescLeft">&#160;</td><td class="mdescRight">The SPI0 delay register. <br /></td></tr>
<tr class="separator:ae03a297fa1980db6a6193caa495165fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6170d0590afeb3c279c01128d83c9015"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a6170d0590afeb3c279c01128d83c9015"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ninja_2spi_8c.html#a6170d0590afeb3c279c01128d83c9015">SPIDEF</a>&#160;&#160;&#160;(*((volatile unsigned int*)(<a class="el" href="ninja_2spi_8c.html#a4a3757b6bf87a9402b4cc6ff355dd015">SPI_BASE</a> + 0x4C)))</td></tr>
<tr class="memdesc:a6170d0590afeb3c279c01128d83c9015"><td class="mdescLeft">&#160;</td><td class="mdescRight">The SPI0 default chip select register. <br /></td></tr>
<tr class="separator:a6170d0590afeb3c279c01128d83c9015"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3c16f1d8402d702944b7a5c5de927438"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a3c16f1d8402d702944b7a5c5de927438"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ninja_2spi_8c.html#a3c16f1d8402d702944b7a5c5de927438">SPIFMT0</a>&#160;&#160;&#160;(*((volatile unsigned int*)(<a class="el" href="ninja_2spi_8c.html#a4a3757b6bf87a9402b4cc6ff355dd015">SPI_BASE</a> + 0x50)))</td></tr>
<tr class="memdesc:a3c16f1d8402d702944b7a5c5de927438"><td class="mdescLeft">&#160;</td><td class="mdescRight">The SPI0 data format register 0. <br /></td></tr>
<tr class="separator:a3c16f1d8402d702944b7a5c5de927438"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a50f093535b4164ab6ef925198e7cc4b2"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a50f093535b4164ab6ef925198e7cc4b2"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ninja_2spi_8c.html#a50f093535b4164ab6ef925198e7cc4b2">SPITxFULL</a>&#160;&#160;&#160;(<a class="el" href="ninja_2spi_8c.html#a3819917ebf65619cc08363b994124216">SPIBUF</a> &amp; 0x20000000)</td></tr>
<tr class="memdesc:a50f093535b4164ab6ef925198e7cc4b2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if the transmit data buffer is full. <br /></td></tr>
<tr class="separator:a50f093535b4164ab6ef925198e7cc4b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abe92caedff5bb318e41cdd0fc53d5702"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="abe92caedff5bb318e41cdd0fc53d5702"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ninja_2spi_8c.html#abe92caedff5bb318e41cdd0fc53d5702">SPIRxEMPTY</a>&#160;&#160;&#160;(<a class="el" href="ninja_2spi_8c.html#a3819917ebf65619cc08363b994124216">SPIBUF</a> &amp; 0x80000000)</td></tr>
<tr class="memdesc:abe92caedff5bb318e41cdd0fc53d5702"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check if the receive data buffer is empty. <br /></td></tr>
<tr class="separator:abe92caedff5bb318e41cdd0fc53d5702"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a4bb7874eaf4a6b816c819510f0f331cb"><td class="memItemLeft" align="right" valign="top">unsigned short&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ninja_2spi_8c.html#a4bb7874eaf4a6b816c819510f0f331cb">spi_update</a> (unsigned short data)</td></tr>
<tr class="memdesc:a4bb7874eaf4a6b816c819510f0f331cb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Send data via the SPI0 controller and get an updated value received by the SPI0 controller.  <a href="#a4bb7874eaf4a6b816c819510f0f331cb">More...</a><br /></td></tr>
<tr class="separator:a4bb7874eaf4a6b816c819510f0f331cb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae909944aa85ae98323073c628be541aa"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ninja_2spi_8c.html#ae909944aa85ae98323073c628be541aa">spi_init</a> (void)</td></tr>
<tr class="memdesc:ae909944aa85ae98323073c628be541aa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize the SPI0 controller and the required GPIO pins.  <a href="#ae909944aa85ae98323073c628be541aa">More...</a><br /></td></tr>
<tr class="separator:ae909944aa85ae98323073c628be541aa"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This contains function definitions required to interact with the SPI0 controller of the SoC which is connected to the ADC. </p>
<dl class="section author"><dt>Author</dt><dd>Tobias Schießl, ev3ninja </dd></dl>
</div><h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="ae909944aa85ae98323073c628be541aa"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void spi_init </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize the SPI0 controller and the required GPIO pins. </p>
<p>For the GPIO pins, the SPI functionality will be set instead of the GPIO functionality.</p>
<dl class="section return"><dt>Returns</dt><dd>none </dd></dl>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="ninja_2spi_8c_ae909944aa85ae98323073c628be541aa_cgraph.png" border="0" usemap="#ninja_2spi_8c_ae909944aa85ae98323073c628be541aa_cgraph" alt=""/></div>
<map name="ninja_2spi_8c_ae909944aa85ae98323073c628be541aa_cgraph" id="ninja_2spi_8c_ae909944aa85ae98323073c628be541aa_cgraph">
<area shape="rect" id="node2" href="ninja_2gpio_8c.html#a8cc18d800719367f95a7c1b1496e4267" title="Initialize a GPIO pin with its GPIO functionality. " alt="" coords="116,5,211,32"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a4bb7874eaf4a6b816c819510f0f331cb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned short spi_update </td>
          <td>(</td>
          <td class="paramtype">unsigned short&#160;</td>
          <td class="paramname"><em>data</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Send data via the SPI0 controller and get an updated value received by the SPI0 controller. </p>
<p>Since the SPI0 controller is configured for chip select 3 only, all data sent and received will be to or from the ADC. According to the documentation of the ADC, the selected channel (0 to 15) will be probed and returned on frame n+2. Therefore, the command is sent 3 times and only the third value received is returned to the caller of this function.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">data</td><td>- The data to send (since this is data to the ADC, check the ADC documentation for possible commands that can be sent)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The value received from the ADC after sending the data 3 times </dd></dl>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.10
</small></address>
</body>
</html>
